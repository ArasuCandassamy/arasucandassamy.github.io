{% comment %}
Static language switcher - no JavaScript required
Determine current language and create appropriate links
{% endcomment %}
{% assign current_lang = page.lang | default: site.default_lang | default: "fr" %}
{% comment %}Fallback: detect language from URL if page.lang is not set{% endcomment %}
{% if page.url contains '/en/' %}
  {% assign current_lang = "en" %}
{% endif %}

{% assign other_lang = "en" %}
{% assign target_url = "" %}

{% if current_lang == "en" %}
  {% assign other_lang = "fr" %}
  {% comment %}Convert English URL to French{% endcomment %}
  {% if page.url == "/en/" %}
    {% assign target_url = "/" %}
  {% elsif page.url == "/en/cv/" %}
    {% assign target_url = "/cv/" %}
  {% elsif page.url == "/en/about/" %}
    {% assign target_url = "/about/" %}
  {% elsif page.url == "/en/teaching/" %}
    {% assign target_url = "/teaching/" %}
  {% else %}
    {% assign target_url = page.url | replace: "/en/", "/" %}
  {% endif %}
{% else %}
  {% assign other_lang = "en" %}
  {% comment %}Convert French URL to English{% endcomment %}
  {% if page.url == "/" %}
    {% assign target_url = "/en/" %}
  {% elsif page.url == "/cv/" %}
    {% assign target_url = "/en/cv/" %}
  {% elsif page.url == "/about/" %}
    {% assign target_url = "/en/about/" %}
  {% elsif page.url == "/teaching/" %}
    {% assign target_url = "/en/teaching/" %}
  {% else %}
    {% assign target_url = "/en" | append: page.url %}
  {% endif %}
{% endif %}

{% assign languages = site.data.languages %}

<div class="language-switcher">
  <a href="{{ target_url | relative_url }}" class="language-btn">
    <span class="flag">{{ languages.languages[other_lang].flag }}</span>
    <span class="lang-name">{{ languages.languages[other_lang].name }}</span>
  </a>
</div>

<style>
.language-switcher {
  position: fixed;
  top: 12px;
  right: 20px;
  z-index: 1000;
}

.language-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: var(--global-bg-color, #fff);
  border: 2px solid var(--global-border-color, #ddd);
  border-radius: 25px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  font-size: 14px;
  font-weight: 500;
  color: var(--global-text-color, #333);
  text-decoration: none;
}

.language-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  border-color: var(--global-link-color, #52adc8);
  text-decoration: none;
  color: var(--global-text-color, #333);
}

.flag {
  font-size: 16px;
}

.lang-name {
  min-width: 60px;
  text-align: left;
}

/* Dark mode styles */
html[data-theme="dark"] .language-btn {
  background: var(--global-bg-color, #333);
  border-color: rgba(255, 255, 255, 0.2);
  color: var(--global-text-color, #fff);
}

html[data-theme="dark"] .language-btn:hover {
  border-color: var(--global-link-color, #52adc8);
  background: rgba(255, 255, 255, 0.05);
  color: var(--global-text-color, #fff);
}
</style>
